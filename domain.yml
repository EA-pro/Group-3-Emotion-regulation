version: "3.1"

intents:
  - greet
  - mood_select
  - mood_happy
  - mood_sad
  - mood_angry
  - not_feeling_better
  - affirm
  - deny
  - pick_reason
  - share_detail
  - check_mood
  - restart_conversation
  - ask_question
  - play_riddle
  - summarize

entities:
  - mood
  - affirmation
  - denial
  - reason

slots:
  mood:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: mood
      - type: from_text
        intent: mood_select
      - type: from_intent
        intent: mood_happy
        value: happy
      - type: from_intent
        intent: mood_sad
        value: sad
      - type: from_intent
        intent: mood_angry
        value: angry

  reason:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: reason
      - type: from_text
        intent: share_detail

  reason_detail:
    type: text
    influence_conversation: false
    mappings:
      - type: from_text

  support_stage:
    type: text
    influence_conversation: false

  expect_free_reason:
    type: bool
    influence_conversation: false

  support_completed:
    type: bool
    influence_conversation: false

  last_mood:
    type: text
    influence_conversation: false

  reframe_stage:
    type: text
    influence_conversation: true

  riddle_question:
    type: text
    influence_conversation: false

  riddle_answer:
    type: text
    influence_conversation: false

  riddle_attempts:
    type: float
    influence_conversation: false

  guess:
    type: text
    influence_conversation: false

  riddle_trigger_text:
    type: text
    influence_conversation: false

forms:
  riddle_form:
    required_slots:
      - guess

responses:
  utter_ask_mood_intro:
  - text: "Before we talk, can you show me how you are feeling by choosing an emoji that fits your mood? ğŸ¤”"
    buttons:
      - title: "ğŸ˜¡ Angry"
        payload: "/mood_angry{{\"mood\":\"angry\"}}"
      - title: "ğŸ˜• Sad"
        payload: "/mood_sad{{\"mood\":\"sad\"}}"
      - title: "ğŸ˜Š Happy"
        payload: "/mood_happy{{\"mood\":\"happy\"}}"

  utter_supportive_message:
    - text: "Hey there! I can help you understand your feelings and think of gentle ways to calm down, but I canâ€™t replace a real person you trust. Youâ€™re not alone, letâ€™s take it one step at a time together. ğŸ’›"

  utter_ask_mood:
    - text: "Before we talk, can you show me how you are feeling by choosing an emoji that fits your mood? ğŸ¤”"


  utter_reflect_mood_happy:
    - text: "Yay, youâ€™re feeling happy! ğŸ˜Š That makes me smile too. And if you ever have a tough moment or feel upset, you can always come back to me. Iâ€™m here for you, every single time."

  utter_reflect_mood_sad:
    - text: "Itâ€™s okay to feel sad. Thank you for trusting me and telling me. Sad feelings can feel heavy, but youâ€™re not alone, we can take this slowly together."

  utter_reflect_mood_angry:
    - text: "It sounds like you're feeling really angry right now. That's okay, big feelings can be tough to hold. I'm right here with you, and we can take some calm steps together to help your body settle down."

  utter_reason_why_you_feel_upset_question:
    - text: "Let's slow down for a moment. ğŸ’› Do you know what made you feel upset?"
      buttons:
        - title: "Yes"
          payload: '/affirm{{"affirmation":"yes"}}'
        - title: "No"
          payload: '/deny{{"denial":"no"}}'

  utter_acknowledge_uneasy_feeling:
    - text: "Thatâ€™s completely okay. ğŸ’› Sometimes our heart feels a bit heavy even if we donâ€™t really know why."


  utter_overview_common_reasons_sad:
    - text: "Here are some common reasons children might feel sad:" 
      buttons:
        - title: "I'm tired"
          payload: '/pick_reason{{"reason":"tired"}}'
        - title: "I miss someone"
          payload: '/pick_reason{{"reason":"missing_someone"}}'
        - title: "Something changed at home"
          payload: '/pick_reason{{"reason":"change_in_routine"}}'
        - title: "Worried about school"
          payload: '/pick_reason{{"reason":"worry_school"}}'
        - title: "I don't know"
          payload: '/pick_reason{{"reason":"dont_know"}}'


  utter_overview_common_reasons_angry:
    - text: "Here are some common reasons children might feel angry:"
      buttons:
        - title: "I feel frustrated"
          payload: '/pick_reason{{"reason":"frustration"}}'
        - title: "Someone upset me"
          payload: '/pick_reason{{"reason":"someone_bothered_me"}}'
        - title: "I feel ignored"
          payload: '/pick_reason{{"reason":"feeling_ignored"}}'
        - title: "Loud/noisy environment"
          payload: '/pick_reason{{"reason":"overstimulation"}}'
        - title: "I don't know"
          payload: '/pick_reason{{"reason":"dont_know"}}'


  utter_ask_reason_after_affirm:
    - text: "Thank you for sharing that you know why you feel {mood}. I'm listening â€” what happened?"



  utter_can_do_something_else:
    - text: "Thank you for sharing that with me. If you'd like, you can tell me a bit more, or we can try something gentle together to help your body calm down â€” what feels best for you right now?"


  utter_reason_unknown_exercise:
    - text: "Itâ€™s completely okay not to know. ğŸ’› Letâ€™s give your heart and body a moment to settle. How about a tiny calm break and take a slow sip of water. What would you like to do next?"
      buttons:
        - title: "ğŸ” Show me common reasons"
          payload: '/affirm{{"affirmation":"yes"}}'
        - title: "ğŸ¯ Play a riddle"
          payload: "/play_riddle"
        - title: "ğŸ’¬ Just talk"
          payload: "/greet"

  utter_reason_unknown_ask_later: 
    - text: "ğŸ’›. Sometimes it takes time to understand a feeling. If later on you start to notice what made you feel this way, you can always come back and tell me. Iâ€™ll be right here."


  utter_stage_common_ground:
    - text: "I hear that you're feeling {mood} because of {reason}. Thank you for sharing that with me â€” that took courage. We don't need to understand everything right now â€” we can just be here together, at your pace."

  utter_stage_acceptance:
    - text: "It's totally okay to feel this way. There's no need to fix or explain it. When you're ready, we can look gently at what happened to make it feel bigger. Would you like to continue?"

  utter_stage_analysis:
    - text: "Think of what really happened, was it actually so bad or now that you relaxed a bit was it maybe not as big as you initially thought?"

  utter_stage_nuance:
    - text: "Now that youve thought about it was it really as bad or maybe its just one little thing and life goes on. Just keep relaxing like Feelix says ;)"

  utter_stage_continue_question:
    - text: "Do you agree with this point of view?"
      buttons:
        - title: "Yes"
          payload: '/affirm{{"affirmation":"yes"}}'
        - title: "No"
          payload: '/deny{{"denial":"no"}}'

  utter_support_done:
    - text: "Thanks for going through that. If you ever want to do it again or explore more, Iâ€™m here for you."

  utter_support_done_check_mood:
    - text: "Now that we've taken those steps, are you feeling better?"
      buttons:
        - title: "ğŸ˜Š Feeling better"
          payload: "/mood_happy{{\"mood\":\"happy\"}}"
        - title: "Not feeling better"
          payload: "/not_feeling_better"

  utter_followup_mood_happy:
    - text: "Iâ€™m really glad youâ€™re feeling better now. ğŸ’› If you ever want to talk again, Iâ€™ll be right here."

  utter_followup_mood_sad:
    - text: "Thank you for telling me. If youâ€™re still feeling sad, we can go gently again or take a small pause together."

  utter_followup_mood_angry:
    - text: "Thanks for sharing that youâ€™re still feeling angry. We can take another round if you want, or pause and breathe."

  utter_followup_not_better:
    - text: "Thanks for telling me. We can pause here. If you want to start again, just say hi."

  utter_divider:
    - text: "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"



  utter_reframe_ask_more:
    - text: "Can you share a bit more about {reason}? Whatâ€™s the hardest part for you right now?"

  utter_reframe_reflection:
    - text: "It makes sense to feel {mood} about {reason}. From what you shared: {detail}. That shows you care a lot and are trying to stay connected."

  utter_reframe_alternative:
    - text: "Hereâ€™s a gentler way to see it: even though {reason}, youâ€™re already finding ways to cope. One small idea: take five slow breaths, hold something that reminds you of them, send a short message, and plan a tiny check-in so you feel connected."

  utter_reframe_gratitude:
    - text: "Iâ€™m really glad I could help with this. If you ever want to talk again or try another idea, Iâ€™m here for you. ğŸ’›"

  utter_restart_ok:
    - text: "Of course â€” we can start over. ğŸ’›"

  utter_ask_riddle_form_guess:
    - text: "What's your guess?"

  utter_free_chitchat_response:
    - text: "placeholder"
      metadata:
        rephrase: True
        rephrase_prompt: |
          The following is a conversation with an AI assistant built with Rasa.
          The assistant can talk about itself and that (itself)Feelix is made to guide you through psychological steps to ensure you feel better after a short chat.
          if you want you can go through these steps or if you dont know why you are feeling a certain way you can try some of my riddles!
          Greet me to go through my steps or ask me to play a riddle.
          Here is context / previous conversation with the user:
          {{history}}
          {{current_input}}
          Suggested AI Response:
 
actions:
  - action_start_reflect_flow
  - action_handle_reason_response
  - action_handle_pick_reason
  - action_handle_support_flow
  - action_get_stored_mood
  - action_handle_reframe_flow
  - action_restart_conversation
  - action_fetch_riddle
  - validate_riddle_form
  - action_reset_riddle
  - action_generate_rapport
  - action_clear_support_state
