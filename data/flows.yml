flows:
  sibling_conflict_flow:
    description: Handle anger from sibling conflicts with counting exercise
    steps:
      - collect: emotional_state
        description: Child selects emotional state
        next:
          - if: slots.emotional_state == "really mad"
            then:
              - action: utter_greet_angry
              - collect: trigger_situation
                description: Ask what happened
              - action: utter_acknowledge_situation
              - action: utter_validate_anger
              - collect: wants_counting
                description: Ask if they want to try counting
                next:
                  - if: slots.wants_counting in ["yes", "yeah", "ok", "fine", "I guess"]
                    then:
                      - action: utter_count_together
                      - collect: counting_feeling
                        description: Check how they feel after counting
                      - action: utter_normalize_feeling
                      - action: utter_check_final_feeling
                      - collect: final_emotional_state
                        description: Final emotional check
                      - action: utter_praise_progress
                        next:
                          - action: utter_anything_else
                  - else:
                      - action: utter_offer_help
                        next:
                          - action: utter_anything_else

  friend_issue_flow:
    description: Handle friend disappointment with communication strategy
    steps:
      - collect: emotional_state
        description: Child selects emotional state
        next:
          - if: slots.emotional_state == "a bit annoyed"
            then:
              - action: utter_greet_annoyed
              - collect: trigger_situation
                description: Ask what's bothering them
              - action: utter_acknowledge_friend_situation
              - action: utter_validate_frustration
              - collect: wants_communication
                description: Ask if they want to try communication
                next:
                  - if: slots.wants_communication in ["yes", "yeah", "ok", "maybe", "I guess"]
                    then:
                      - action: utter_suggest_communication
                      - action: utter_acknowledge_willingness
                      - action: utter_check_final_feeling
                      - collect: final_emotional_state
                        description: Final emotional check
                      - action: utter_celebrate_improvement
                        next:
                          - action: utter_anything_else
                  - else:
                      - action: utter_offer_help
                        next:
                          - action: utter_anything_else

  general_support_flow:
    description: Simple support flow for any emotion
    steps:
      - collect: emotional_state
        description: Child selects emotional state
      - action: utter_ask_trigger_situation
      - collect: trigger_situation
        description: What's bothering them
      - action: utter_general_acknowledgment
      - action: utter_offer_help
      - collect: help_preference
        description: What kind of help they want
      - action: utter_provide_strategy
      - action: utter_check_final_feeling
      - collect: final_emotional_state
        description: Final emotional check
      - action: utter_general_praise
        next:
          - action: utter_anything_else
