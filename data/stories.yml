version: "3.1"

stories:

- story: mood happy via button
  steps:
  - intent: mood_happy
  - slot_was_set:
    - mood: happy
  - action: action_start_reflect_flow

- story: mood sad via button
  steps:
  - intent: mood_sad
  - slot_was_set:
    - mood: sad
  - action: action_start_reflect_flow

- story: mood angry via button
  steps:
  - intent: mood_angry
  - slot_was_set:
    - mood: angry
  - action: action_start_reflect_flow

- story: mood sad -> know reason? no
  steps:
  - intent: mood_sad
  - slot_was_set:
    - mood: sad
  - action: action_start_reflect_flow
  - action: action_listen
  - intent: deny
  - action: action_handle_reason_response
  - action: utter_acknowledge_uneasy_feeling
  - action: utter_overview_common_reasons_sad
  - action: action_listen
  - intent: pick_reason
    user: |-
      /pick_reason{"reason":"dont_know"}
  - action: action_handle_pick_reason
  - action: utter_reason_unknown_exercise
  - action: utter_reason_unknown_ask_later
  # End flow when user chooses 'I don't know' (no support flow triggered automatically)

- story: mood angry -> know reason? no
  steps:
  - intent: mood_angry
  - slot_was_set:
    - mood: angry
  - action: action_start_reflect_flow
  - action: action_listen
  - intent: deny
  - action: action_handle_reason_response
  - action: utter_acknowledge_uneasy_feeling
  - action: utter_overview_common_reasons_angry
  - action: action_listen
  - intent: pick_reason
    user: |-
      /pick_reason{"reason":"dont_know"}
  - action: action_handle_pick_reason
  - action: utter_reason_unknown_exercise
  - action: utter_reason_unknown_ask_later
  # End flow when user chooses 'I don't know' (no support flow triggered automatically)

- story: mood angry -> know reason? yes -> pick reason
  steps:
  - intent: mood_angry
  - slot_was_set:
    - mood: angry
  - action: action_start_reflect_flow
  - action: action_listen
  - intent: affirm
  - action: action_handle_reason_response
  - action: utter_ask_reason_after_affirm
  - action: action_listen
  - intent: pick_reason
    user: |-
      /pick_reason{"reason":"frustration"}
  - action: action_handle_pick_reason
  - action: action_handle_reframe_flow

- story: mood sad -> know reason? yes -> pick reason
  steps:
  - intent: mood_sad
  - slot_was_set:
    - mood: sad
  - action: action_start_reflect_flow
  - action: action_listen
  - intent: affirm
  - action: action_handle_reason_response
  - action: utter_ask_reason_after_affirm
  - action: action_listen
  - intent: pick_reason
    user: |-
      /pick_reason{"reason":"tired"}
  - action: action_handle_pick_reason
  - action: action_handle_reframe_flow
  - action: action_listen
  - intent: affirm
  - action: action_handle_reframe_flow

- story: reframe disagree loop
  steps:
  - intent: mood_sad
  - slot_was_set:
    - mood: sad
  - action: action_start_reflect_flow
  - action: action_listen
  - intent: pick_reason
    user: |-
      /pick_reason{"reason":"missing_someone"}
  - action: action_handle_pick_reason
  - action: action_handle_reframe_flow
  - action: action_listen
  - intent: deny
  - action: action_handle_reframe_flow

- story: reframe agree wrap
  steps:
  - intent: mood_sad
  - slot_was_set:
    - mood: sad
  - action: action_start_reflect_flow
  - action: action_listen
  - intent: pick_reason
    user: |-
      /pick_reason{"reason":"missing_someone"}
  - action: action_handle_pick_reason
  - action: action_handle_reframe_flow
  - action: action_listen
  - intent: affirm
  - action: action_handle_reframe_flow

- story: share detail during support flow
  steps:
  - intent: mood_sad
  - slot_was_set:
    - mood: sad
  - action: action_start_reflect_flow
  - action: action_listen
  - intent: affirm
  - action: action_handle_reason_response
  - action: utter_ask_reason_after_affirm
  - action: action_listen
  - intent: pick_reason
    user: |-
      /pick_reason{"reason":"missing_someone"}
  - action: action_handle_pick_reason
  - action: action_handle_reframe_flow
  - action: action_listen
  - intent: share_detail
  - action: action_handle_reframe_flow
  - action: action_listen
  - intent: affirm
  - action: action_handle_reframe_flow

- story: free text reason flows to reframe (sad)
  steps:
  - intent: mood_sad
  - slot_was_set:
    - mood: sad
  - action: action_start_reflect_flow
  - action: action_listen
  - intent: affirm
  - action: action_handle_reason_response
  - action: utter_ask_reason_after_affirm
  - action: action_listen
  - intent: share_detail
  - action: action_handle_pick_reason
  - action: action_handle_reframe_flow
  - action: action_listen
  - intent: affirm
  - action: action_handle_reframe_flow

- story: query stored mood
  steps:
  - intent: check_mood
  - action: action_get_stored_mood

- story: play riddle directly
  steps:
  - intent: play_riddle
  - action: action_fetch_riddle
  - action: riddle_form
  - active_loop: riddle_form

- story: play riddle after unknown reason (sad)
  steps:
  - intent: mood_sad
  - slot_was_set:
    - mood: sad
  - action: action_start_reflect_flow
  - action: action_listen
  - intent: deny
  - action: action_handle_reason_response
  - action: utter_acknowledge_uneasy_feeling
  - action: utter_overview_common_reasons_sad
  - action: action_listen
  - intent: pick_reason
    user: |-
      /pick_reason{"reason":"dont_know"}
  - action: action_handle_pick_reason
  - action: utter_reason_unknown_exercise
  - action: utter_reason_unknown_ask_later
  - action: action_listen
  - intent: play_riddle
  - action: action_fetch_riddle
  - action: riddle_form
  - active_loop: riddle_form
